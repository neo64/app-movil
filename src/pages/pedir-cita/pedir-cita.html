<ion-header>
  <ion-navbar color="primary">
    <button ion-button menuToggle>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title>Pedir cita</ion-title>
  </ion-navbar>
</ion-header>


<ion-content padding>
	<!-- this fab is placed at bottom right -->
	 <ion-fab bottom right #fab1>
	   <button ion-fab (click)="openPage('Chat', 'page')" >
	   		<svg style="    width: 60%;    height: 60%;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64">
	   			<g fill="white" stroke="none"> 
	   				<path d="M51.1 34.1V11.2c0-3.2-2.6-5.8-5.8-5.8H6.6C3.4 5.4.8 8 .8 11.2v22.9c0 3.2 2.6 5.8 5.8 5.8h1.6v6.9c0 1.3 1 2.3 2.3 2.3.7 0 1.3-.3 1.7-.8l7.3-8.4h25.8c3.2 0 5.8-2.6 5.8-5.8zm-32.3 2.7c-.5 0-.9.2-1.2.5l-6.3 7.3v-6.3c0-.9-.7-1.6-1.6-1.6H6.6c-1.5 0-2.6-1.2-2.6-2.6V11.2c0-1.5 1.2-2.6 2.6-2.6h38.7c1.5 0 2.6 1.2 2.6 2.6v22.9c0 1.5-1.2 2.6-2.6 2.6H18.8zm0 0"/>
	   				<path d="M51.7 57.7c.4.5 1.1.8 1.7.8.3 0 .5-.1.8-.2.9-.3 1.5-1.2 1.5-2.2v-6.9h1.6c3.2 0 5.8-2.6 5.8-5.8V20.7c0-3.2-2.6-5.8-5.8-5.8-.9 0-1.6.7-1.6 1.6 0 .9.7 1.6 1.6 1.6 1.5 0 2.6 1.2 2.6 2.6v22.9c0 1.5-1.2 2.6-2.6 2.6h-3.2c-.9 0-1.6.7-1.6 1.6V54l-6.3-7.3c-.3-.3-.7-.5-1.2-.5H21.7c-.9 0-1.6.7-1.6 1.6 0 .9.7 1.6 1.6 1.6h22.7l7.3 8.3zm0 0M27.8 23.2c0 1-.8 1.9-1.9 1.9-1 0-1.9-.8-1.9-1.9 0-1 .8-1.9 1.9-1.9 1.1.1 1.9.9 1.9 1.9zm0 0M34 23.2c0 1-.8 1.9-1.9 1.9-1 0-1.9-.8-1.9-1.9 0-1 .8-1.9 1.9-1.9 1.1.1 1.9.9 1.9 1.9zm0 0M21.6 23.2c0 1-.8 1.9-1.9 1.9-1 0-1.9-.8-1.9-1.9 0-1 .8-1.9 1.9-1.9 1.1.1 1.9.9 1.9 1.9zm0 0"/>
   				</g>
   			</svg>	   	
	   </button>	   
	 </ion-fab>
	<div>
		<ion-card detail-none  style="margin: 0px 0px 15px 0px;width:100%;    background: #c3e6cb;    color: #155724;    text-align: justify;    padding: 1.5rem;    border-radius: 1rem;">
			<div style="width: 100%;    height: 100%;">
				<div style="width:100%;height:100%;float:left;">
					Los campos de fecha, hora y preferencia de dias son opcionales, si no se rellenan se obtendrá la primera cita disponible.
				</div>				
			</div>
		</ion-card>
	</div>
	<form #form="ngForm" (ngSubmit)="searchCita(form);showLoading('Buscando citas');" novalidate style="margin-bottom:5rem;">
		<ion-item>
			<ion-label>Higienista</ion-label>
			<ion-select required interface="action-sheet" (ngModelChange)="drSeleccionado($event)" [(ngModel)]="dr" name="dr" okText="OK" cancelText="Cancelar">
				<ion-option [value]="cualquiera" selected>Sin preferencia</ion-option>
				<ion-option *ngFor="let d of doctores" [value]="d.agenda">{{d.usuario}}</ion-option>
			</ion-select>
		</ion-item>
		<ion-item>
			<ion-label>Tratamiento</ion-label>
			<ion-select required="yes" interface="action-sheet" [(ngModel)]="tto" name="tto" disabled="{{!isDrSelected}}" okText="OK" cancelText="CANCELAR">
				<ion-option *ngFor="let t of tratamientos" [value]="t">{{t.Descripcio}}</ion-option>
			</ion-select>
		</ion-item>
		<ion-item>
			<ion-label>Fecha</ion-label>
			<ion-datetime min="2018" max="2020"  name="date" displayFormat="DD/MM/YYYY" [(ngModel)]="date" doneText="OK" cancelText="CANCELAR"></ion-datetime>
		</ion-item>
		<ion-item>
			<ion-label>Hora</ion-label>
			<ion-datetime required min="09:30" max="20:30" name="hour" displayFormat="HH:mm" [(ngModel)]="hour" doneText="OK" cancelText="CANCELAR"></ion-datetime>
		</ion-item>
		<ion-item>
			<ion-label>Preferencia de dias</ion-label>
			<ion-select [(ngModel)]="dias" name="dias" multiple="true" okText="OK" cancelText="CANCELAR">
				<ion-option value="lm">Lunes mañana</ion-option>
				<ion-option value="lt">Lunes tarde</ion-option>
				<ion-option value="mm">Martes mañana</ion-option>
				<ion-option value="mt">Martes tarde</ion-option>
				<ion-option value="xm">Miercoles mañana</ion-option>
				<ion-option value="xt">Miercoles tarde</ion-option>
				<ion-option value="jm">Jueves mañana</ion-option>
				<ion-option value="jt">Jueves tarde</ion-option>
				<ion-option value="vm">Viernes mañana</ion-option>
				<ion-option value="vt">Viernes tarde</ion-option>
			</ion-select>
		</ion-item>	
		
		<button ion-button type="submit" block style="margin-top: 1rem;"><i style="margin-right: 0.5rem;" class="fas fa-search"></i>  Buscar</button>
	</form>
	<div *ngIf="show">
		<div *ngFor="let item of citasBuscador; let i=index">
			<ion-card>
				<div *ngIf="i<5">
					<ion-card-content >	
						<p class="left" style="color:#5f5f62 !important">{{item.fecha}} </p>
						<p class="left" style="font-size: 14px;margin-top: -0.55em;color:#5f5f62 !important">{{item.diaSemana}}</p>
						<hr>
						<p class="left" style="color:#5f5f62 !important"><i style="width: 3%;" class="far fa-clock marginRight primary" aria-hidden="true"></i> {{item.fIniDr}} - {{item.fFinDr}}</p>
						<p class="left" style="color:#5f5f62 !important"><i style="width: 3%;" class="fas fa-user-md marginRight primary" aria-hidden="true"></i> {{item.nombreDr}}</p>
						<p class="left" style="color:#5f5f62 !important"><i style="width: 3%;" class="fas fa-notes-medical marginRight primary" aria-hidden="true"></i> {{ttoSelect}} </p>
					</ion-card-content>		
					<ion-row class="cardfooter" style="font-size: 1.6rem;border-top: 1px solid lightgrey;">
						<ion-col class="left primary" >
							<span (click)="solicitarCita(item.fecha,item.fIniDr,item.nombreDr,ttoSelect)"><i style="margin-right: 0.2rem;height: 3rem; margin-top: 1.5rem; margin-left: 1rem;" class="fas fa-plus marginRight primary" aria-hidden="true"></i> Solicitar</span>
						</ion-col>
					</ion-row>
				</div>
			</ion-card>  
		</div>
	</div>
	<div *ngIf="show != true">
		<ion-card detail-none  style="margin: 15px 0px 15px 0px;width:100%;    background: #ebcccc;    color: #a94442;    text-align: center;    padding: 1.5rem;    border-radius: 1rem;">
			<div style="width: 100%;    height: 100%;">
				<div style="width:100%;height:100%;float:left;">
					No hemos encontrado citas con los criterios de búsqueda.
				</div>				
			</div>
		</ion-card>
	</div>

</ion-content>
